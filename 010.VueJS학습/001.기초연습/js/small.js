// ì‡¼í•‘ëª° ê°¤ëŸ¬ë¦¬ JS - small.js

// í…œí”Œë¦¿ htmlì½”ë“œ ê°ì²´ JS ê°€ì ¸ì˜¤ê¸°
import hcode from "./hcode.js";

// ë·°JS ì¸ìŠ¤í„´ìŠ¤ ìƒì„±ìš© í•¨ìˆ˜!
const makeVue = (x) => new Vue({ el: x });

// 1. ì œëª©ì— ë„£ì„ ì „ì—­ì»´í¬ë„ŒíŠ¸ ë§Œë“¤ê¸°

Vue.component("tit-comp", {
    template: hcode.tit,
}); ///// ì „ì—­ ì»´í¬ë„ŒíŠ¸ 1 ///////

// ë·°ì¸ìŠ¤í„´ìŠ¤ ìƒì„±í•˜ê¸° : ë°˜ë“œì‹œ ì»´í¬ë„ŒíŠ¸ ì•„ë˜ì—ì„œ í•¨!
makeVue(".tit");

// new Vue({
//     el:".tit"
// })
// new Vue({
//     el:".tit2"
// })

// ìˆ«ìì¦ê° ë³€ìˆ˜
let num = 0;

// 2. ê°¤ëŸ¬ë¦¬ ë¦¬ìŠ¤íŠ¸ì— ë„£ì„ ì „ì—­ì»´í¬ë„ŒíŠ¸ ë§Œë“¤ê¸°
// ì—¬ê¸°ê°€ ìì‹ì…ë‹ˆë‹¤!!!
Vue.component("list-comp", {
    //  v-on:click="goPapa" ë¡œ ë¶€ëª¨ì´ë²¤íŠ¸ ì ‘ê·¼ì‹œì‘!
    template: hcode.list,
    // ë¶€ëª¨ì—ì„œ v-bind:ì†ì„±ëª…=ê°’ ìœ¼ë¡œ ì „ë‹¬í•œ ì†ì„±ë³€ìˆ˜ë¥¼
    // props:[]/{} ë¡œ ë°›ìŒ!
    props: ["haha", "myseq", "endlet"],
    // props:{"haha":Number}, //-> ë°ì´í„°í˜• ì¼ì¹˜í•¨!
    // props:{"haha":String}, //-> ë°ì´í„°í˜• ì˜¤ë¥˜ë©”ì‹œì§€ë‚˜ì˜´!
    // ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ ë³€ìˆ˜ì…‹íŒ…
    data: function () {
        return {
            // 1. ìƒí’ˆì´ë¯¸ì§€ ê²½ë¡œ
            gsrc: `img_gallery/${this.haha}.jpg`,
            // 2. ìƒí’ˆëª…
            gname: `Sofia23` + this.haha + this.endlet + (this.myseq % 2 ? "ğŸ˜˜" : "ğŸ‘"),
            // 3. ë‹¨ìœ„ê°€ê²©(ì›ê°€ê²© í™”ë©´í‘œì‹œìš©)
            gprice: this.insComma((123000 * this.haha) / 2) + `ì›`,
            // 4. ë‹¨ìœ„ê°€ê²©(ì›ê°€ê²© ìˆ«ìë§Œ:data-priceì†ì„±ê°’ìœ¼ë¡œ ì…‹íŒ…)
            orgprice: (123000 * this.haha) / 2,
            // 5. í• ì¸ê°€ê²© : 30% í• ì¸ëœ ê°€ê²©(ì›ê°€ê²©*0.7)
            // - ë°˜ì˜¬ë¦¼ Math.round()
            sale: this.insComma(Math.round(((123000 * this.haha) / 2) * 0.7)) + `ì›`,
        };
    },
    // ì»´í¬ë„ŒíŠ¸ ë‚´ë¶€ ë©”ì„œë“œì…‹íŒ…
    methods: {
        // ë¶€ëª¨ì´ë²¤íŠ¸í˜¸ì¶œ ì „ë‹¬í•˜ê¸° : $emit() ë©”ì„œë“œì‚¬ìš©
        goPapa() {
            // $emit(ë¶€ëª¨ê°€ë§Œë“ ì´ë²¤íŠ¸ëª…)
            this.$emit("hull");
        },
        ovNow() {
            this.$emit("gotkimchi");
            // ë¶€ëª¨ ìš”ì†Œì— v-on:gotkimchi=ë©”ì„œë“œëª…
            // ì„ ë§Œë“¤ì–´ì„œ ì‚¬ìš©í•¨!
        },

        //ì •ê·œì‹í•¨ìˆ˜(ìˆ«ì ì„¸ìë¦¬ë§ˆë‹¤ ì½¤ë§ˆí•´ì£¼ëŠ” ê¸°ëŠ¥)
        insComma(x) {
            return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        },

        //ì„¸ì¼í‘œì‹œ ì—¬ë¶€ ë¦¬í„´ ë©”ì„œë“œ
        condiRet() {
            return (
                this.haha == 3 ||
                this.haha == 5 ||
                this.haha == 14 ||
                this.haha == 22 ||
                this.haha == 26 ||
                this.haha == 38 ||
                this.haha == 45 ||
                this.haha == 50
            );
        },
    },
}); ///////////// ë·°JS ì»´í¬ë„ŒíŠ¸ ////////

// ë¦¬ìŠ¤íŠ¸ ë·° ì¸ìŠ¤í„´ìŠ¤ ìƒì„±í•˜ê¸°
// ì—¬ê¸°ê°€ ë¶€ëª¨ì…ë‹ˆë‹¤!!!
new Vue({
    el: ".grid",
    // ë¶€ëª¨ ë·°ì¸ìŠ¤í„´ìŠ¤ ë©”ì„œë“œêµ¬ì—­
    methods: {
        // ìì‹ì´ë²¤íŠ¸ ì „ë‹¬í›„ ì‹¤í–‰ë©”ì„œë“œ!
        goMsg() {
            // alert("ìì‹ì´ ë¶€ëª¨ì—ê²Œ ì´ë²¤íŠ¸ì „ë‹¬ ì„±ê³µ!");
        },
        ovMsg() {
            // console.log("ì˜¤ë²„!ì˜¤ì¼€ì´!");
        },
    },
}); //////////// Vue ì¸ìŠ¤í„´ìŠ¤ //////////

/////// í°ì´ë¯¸ì§€ ë³´ê¸° ë°°ê²½ë°•ìŠ¤ ì»´í¬ë„ŒíŠ¸ /////////////
Vue.component("win-comp", {
    template: hcode.big,
}); ///////// win-comp ì»´í¬ë„ŒíŠ¸ ///////////////////

////////// win-comp ë·°JS ì¸ìŠ¤í„´ìŠ¤ ìƒì„±í•˜ê¸° //////
new Vue({
    el: "#pbg",
    // DOMì´ ëª¨ë‘ ë¡œë”©ëœ í›„ ì‹¤í–‰êµ¬ì—­!
    mounted: function () {
        // [ ì œì´ì¿¼ë¦¬ ê¸°ëŠ¥êµ¬í˜„ ]

        // ê³µìœ ë²ˆí˜¸ë³€ìˆ˜
        let nowNum = 1;
        // ê³µìœ ê°€ê²©ë³€ìˆ˜
        let orgprice = 0;
        // ê³µìœ ì „ì²´ìˆ˜ëŸ‰ë³€ìˆ˜
        let tot = 1;

        // 1. ê°¤ëŸ¬ë¦¬ ë¦¬ìŠ¤íŠ¸ í´ë¦­ì‹œ í°ì´ë¯¸ì§€ë°•ìŠ¤ ë³´ì´ê¸°
        $(".grid>div").click(function (e) {
            console.log(this);
            // 1. í´ë¦­ëœ ì´ë¯¸ì§€ ê²½ë¡œ ì½ì–´ì˜¤ê¸°
            let isrc = $(this).find("img").attr("src");

            // 2. í´ë¦­ëœ ì´ë¯¸ì§€ ê²½ë¡œë¥¼ í° ì´ë¯¸ì§€ì— srcë¡œ ë„£ê¸°
            $(".gimg img").attr("src", isrc);

            // 3. í°ì´ë¯¸ì§€ë°•ìŠ¤ ë³´ì´ê¸°
            $("#bgbx").show();

            // 4. ë‹¤ìŒ/ì´ì „ ì´ë¯¸ì§€ ë³€ê²½ì„ ìœ„í•œ data-numì†ì„±ì½ê¸°
            nowNum = $(this).attr("data-num");
            console.log("í˜„ì¬ì´ë¯¸ì§€ë²ˆí˜¸:", nowNum);

            // 5. ê°’ ì…‹íŒ…í•˜ê¸°
            setVal();
        }); /////////// click ////////

        // ìƒí’ˆëª…/ ê°€ê²© ë“± ë°ì´í„° ì…‹ì—… í•¨ìˆ˜
        function setVal() {
            // nowNumê°’ì— ì˜í•œ ëŒ€ìƒì„ ì •!
            const tg = $(`.grid>div[data-num=${nowNum}]`);
            // console.log(tg.find("h2").text());
            // console.log(tg.find("h3").text());

            // 1. [ê°€ê²© ê³„ì‚°ì„ ìœ„í•œ ì›ê°€ê²©ì…‹íŒ…]
            orgprice = tg.find("h3>span:first").attr("data-price");

            // 2. ì„¸ì¼ì ìš©ì—¬ë¶€
            let isSale = tg.find("h3>span:first").is(".del");

            // 3. ì„¸ì¼ ì ìš©ì¼ ê²½ìš° ì„¸ì¼ ê°€ê²©ìœ¼ë¡œ ì—…ëƒ!
            if (isSale) {
                orgprice = Math.round(orgprice * 0.7);
            } ///////// if //////////////

            console.log("ì›ê°€ê²©:", orgprice);

            // 4. ìƒí’ˆëª… í°ë°•ìŠ¤ì— ë„£ê¸°
            $("#gtit,#gcode").text(tg.find("h2").text());

            // 5. ìƒí’ˆê°€ê²© í°ë°•ìŠ¤ì— ë„£ê¸°
            // (1) ì›ê°€ê²©ì— í‘œì‹œ
            $("#gprice").html(
                insComma(orgprice) + "ì›"
            );
            // (2) í† íƒˆê°€ê²©ì— í‘œì‹œ : ì›ê°€ * ê°œìˆ˜
            $("#total").html(
                insComma(orgprice * tot) + "ì›"
            );

            // 6. ì„¸ì¼ì¼ ê²½ìš° ì¶”ê°€ë¬¸êµ¬ë„£ê¸°
            if (isSale) {
                $("#gprice").prepend("<small>30% ì„¸ì¼ê°€</small> ");
            } //// if ////
        } ////////// setValí•¨ìˆ˜ //////////////////

        //ì •ê·œì‹í•¨ìˆ˜(ìˆ«ì ì„¸ìë¦¬ë§ˆë‹¤ ì½¤ë§ˆí•´ì£¼ëŠ” ê¸°ëŠ¥)
        function insComma(x) {
            return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        }

        // 2. ë‹«ê¸°ë²„íŠ¼ í´ë¦­ì‹œ í°ì´ë¯¸ì§€ë°•ìŠ¤ ìˆ¨ê¸°ê¸°
        $(".cbtn").click(function (e) {
            e.preventDefault();
            // í°ì´ë¯¸ì§€ë°•ìŠ¤ ìˆ¨ê¸°ê¸°
            $("#bgbx").hide();
        }); /////////// click /////////

        // 3. ì´ì „/ë‹¤ìŒë²„íŠ¼ í´ë¦­ì‹œ ì´ë¯¸ì§€ë³€ê²½í•˜ê¸°
        $(".abtn").click(function (e) {
            // 1. ê¸°ë³¸ì´ë™ë§‰ê¸°
            e.preventDefault();
            // 2. ì˜¤ë¥¸ìª½ë²„íŠ¼ ì—¬ë¶€
            let isB = $(this).is(".rb");

            // 3. ë¶„ê¸°í•˜ê¸°
            if (isB) {
                // ì˜¤ë¥¸ìª½ë²„íŠ¼
                nowNum++;
                if (nowNum === 51) nowNum = 1;
            } else {
                // ì™¼ìª½ë²„íŠ¼
                nowNum--;
                if (nowNum === 0) nowNum = 50;
            }

            console.log("ë³€ê²½ëœnowNum:", nowNum);

            // 4. í° ì´ë¯¸ì§€ ë³€ê²½í•˜ê¸°
            $(".gimg img").attr("src", `img_gallery/${nowNum}.jpg`);

            // 5. ê°’ ì…‹íŒ…í•˜ê¸°
            setVal();
        }); ////////// click ////////////

        // [ ìˆ˜ëŸ‰ì¦ê°€/ê°ì†Œ ë²„íŠ¼ í´ë¦­ì‹œ ë°ì´í„° ë°˜ì˜í•˜ê¸° ]
        // ì´ë²¤íŠ¸ ëŒ€ìƒ : .chg_num img
        // ë³€ê²½ ëŒ€ìƒ : input#sum
        const sum = $("input#sum");

        $(".chg_num img").click(function () {
            // 1. í´ë¦­ëœ ë²„íŠ¼ êµ¬ë¶„í•˜ê¸°
            let isB = $(this).attr("alt");

            // 2. í˜„ì¬ê°’ ì½ì–´ì˜¤ê¸° : ì›ë˜ë¬¸ìí˜•ì„ ìˆ«ìí˜•ìœ¼ë¡œ ë³€í™˜
            let isV = Number(sum.val());

            console.log("ë²„íŠ¼êµ¬ë¶„:", isB);
            console.log("í˜„ì¬ê°’:", isV);

            // 3. ë¶„ê¸°í•˜ê¸°
            // (1) ì¦ê°€ì¼ë•Œ
            if (isB === "ì¦ê°€") {
                sum.val(++isV);
                // sum.val(isV++);
                // isV++ ì´ë©´ í˜„ì¬ê°’ì´ ë³€ê²½ì•ˆë¨!
                // ì™œ? 1ì¦ê°€ì „ì— ë°˜ì˜í•˜ê¸° ë•Œë¬¸!
            } ///////// if ////////

            // (2) ê°ì†Œì¼ë•Œ : í•œê³„ê°’ 1
            else {
                isV = --isV;
                if (isV === 0) isV = 1;
                sum.val(isV);
            } /////// else ///////

            // 4. ê°€ê²©í‘œì‹œí•˜ê¸°
            // ìˆ˜ëŸ‰ì„ ì „ì—­ë³€ìˆ˜ì— í• ë‹¹í•˜ì—¬ setVal()ì— ë°˜ì˜í•¨!

            setVal();
        }); ///////////// click //////////////
    }, //////// mounted í•¨ìˆ˜êµ¬ì—­ /////
}); ///////////// ë·°JS ì¸ìŠ¤í„´ìŠ¤ //////////////////
